(function(o){o.parser("parseSBV",function(b){var l={title:"",remote:"",data:[]},m=[],f=0,k=0,n=function(a){a=a.split(":");var h=a.length-1,i;try{i=parseInt(a[h-1],10)*60+parseFloat(a[h],10);if(h===2)i+=parseInt(a[0],10)*3600}catch(p){throw"Bad cue";}return i},g=function(a,h){var i={};i[a]=h;return i};b=b.text.split(/(?:\r\n|\r|\n)/gm);for(k=b.length;f<k;){var j={},e=[],c=b[f++].split(",");try{j.start=n(c[0]);for(j.end=n(c[1]);f<k&&b[f];)e.push(b[f++]);j.text=e.join("<br />");m.push(g("subtitle",j))}catch(d){for(;f<
k&&b[f];)f++}for(;f<k&&!b[f];)f++}l.data=m;return l})})(Popcorn);(function(o){o.parser("parseSSA",function(b){var l={title:"",remote:"",data:[]},m=[],f,k,n,g,j,e,c,d=0,a=0,h=0,i=0,p=function(s){var q=s.split(":"),r=q.length-1;if(s.length!==10)return-1;return parseInt(q[0],10)*3600+parseInt(q[r-1],10)*60+parseFloat(q[r],10)},t=function(s,q){var r={};r[s]=q;return r};b=b.text.split(/(?:\r\n|\r|\n)/gm);for(h=b.length;d<h&&b[d]!=="[Events]";)d++;g=b[++d].substr(8).split(", ");for(j=g.length;a<j;a++)if(g[a]==="Start")f=a;else if(g[a]==="End")k=a;else if(g[a]==="Text")n=
a;for(;++d<h&&b[d]&&b[d][0]!=="[";){e={};g=b[d].substr(10).split(",");e.start=p(g[f]);e.end=p(g[k]);if(!(e.start===-1||e.end===-1)){if((i=g.length)===j)e.text=g[n];else{c=[];for(a=n;a<i;a++)c.push(g[a]);e.text=c.join(",")}e.text=e.text.replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,"").replace(/\\N/gi,"<br />");m.push(t("subtitle",e))}}l.data=m;return l})})(Popcorn);(function(o){o.parser("parseSRT",function(b){var l={title:"",remote:"",data:[]},m=[],f=0,k=0,n=0,g,j,e,c=function(a){a=a.split(":");try{var h=a[2].split(",");if(h.length===1)h=a[2].split(".");return parseFloat(a[0],10)*3600+parseFloat(a[1],10)*60+parseFloat(h[0],10)+parseFloat(h[1],10)/1E3}catch(i){return 0}},d=function(a,h){var i={};i[a]=h;return i};b=b.text.split(/(?:\r\n|\r|\n)/gm);k=b.length;for(f=0;f<k;f++){e={};j=[];e.id=parseInt(b[f++],10);g=b[f++].split(/[\t ]*--\>[\t ]*/);e.start=c(g[0]);
n=g[1].indexOf(" ");if(n!==-1)g[1]=g[1].substr(0,n);for(e.end=c(g[1]);f<k&&b[f];)j.push(b[f++]);e.text=j.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,"");e.text=e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");e.text=e.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>");e.text=e.text.replace(/\\N/gi,"<br />");m.push(d("subtitle",e))}l.data=m;return l})})(Popcorn);(function(o){o.parser("parseJSON","JSON",function(b){var l={title:"",remote:"",data:[]};o.forEach(b.data,function(m){l.data.push(m)});return l})})(Popcorn);(function(o){o.parser("parseTTML",function(b){var l={title:"",remote:"",data:[]},m,f=0,k,n=function(e,c){if(!e)return-1;var d=e.split(":"),a=d.length-1;if(a>=2)return parseInt(d[0],10)*3600+parseInt(d[a-1],10)*60+parseFloat(d[a],10);for(d=e.length-1;d>=0;d--)if(e[d]<="9"&&e[d]>="0")break;d++;a=e.substr(d);c=c||0;if(a==="h")a=3600;else if(a==="m")a=60;else if(a==="s")a=1;else if(a==="ms")a=0.001;else return-1;return parseFloat(e.substr(0,d))*a+c},g=function(e,c){var d={};d[e]=c;return d},j=function(e,
c){for(var d=e.firstChild,a;d;){if(d.nodeType===1)if(d.nodeName==="p"){a=d;var h=c,i={};i.text=a.textContent.replace(/^[\s]+|[\s]+$/gm,"").replace(/(?:\r\n|\r|\n)/gm,"<br />");i.id=a.getAttribute("xml:id");i.start=n(a.getAttribute("begin"),h);i.end=n(a.getAttribute("end"),h);i.target=k;if(i.end<0){i.end=n(a.getAttribute("duration"),0);if(i.end>=0)i.end+=i.start;else i.end=Number.MAX_VALUE}a=i;l.data.push(g("subtitle",a));f++}else if(d.nodeName==="div"){a=n(d.getAttribute("begin"));if(a<0)a=c;j(d,
a)}d=d.nextSibling}};if(!b.xml||!b.xml.documentElement||!(m=b.xml.documentElement.firstChild))return l;for(;m.nodeName!=="body";)m=m.nextSibling;k="";j(m,0);return l})})(Popcorn);(function(o){o.parser("parseTTXT",function(b){var l={title:"",remote:"",data:[]},m=function(j){j=j.split(":");var e=0;try{return parseFloat(j[0],10)*60*60+parseFloat(j[1],10)*60+parseFloat(j[2],10)}catch(c){e=0}return e},f=function(j,e){var c={};c[j]=e;return c};b=b.xml.lastChild.lastChild;for(var k=Number.MAX_VALUE,n=[];b;){if(b.nodeType===1&&b.nodeName==="TextSample"){var g={};g.start=m(b.getAttribute("sampleTime"));g.text=b.getAttribute("text");if(g.text){g.end=k-0.001;n.push(f("subtitle",g))}k=
g.start}b=b.previousSibling}l.data=n.reverse();return l})})(Popcorn);(function(o){o.parser("parseXML","XML",function(b){var l={title:"",remote:"",data:[]},m={},f=function(c){c=c.split(":");if(c.length===1)return parseFloat(c[0],10);else if(c.length===2)return parseFloat(c[0],10)+parseFloat(c[1]/12,10);else if(c.length===3)return parseInt(c[0]*60,10)+parseFloat(c[1],10)+parseFloat(c[2]/12,10);else if(c.length===4)return parseInt(c[0]*3600,10)+parseInt(c[1]*60,10)+parseFloat(c[2],10)+parseFloat(c[3]/12,10)},k=function(c){for(var d={},a=0,h=c.length;a<h;a++){var i=c.item(a).nodeName,
p=c.item(a).nodeValue;if(i==="in")d.start=f(p);else if(i==="out")d.end=f(p);else if(i==="resourceid")o.extend(d,m[p]);else d[i]=p}return d},n=function(c,d){var a={};a[c]=d;return a},g=function(c,d,a){var h={};o.extend(h,d,k(c.attributes),{text:c.textContent});d=c.childNodes;if(d.length<1||d.length===1&&d[0].nodeType===3)if(a)m[h.id]=h;else l.data.push(n(c.nodeName,h));else for(c=0;c<d.length;c++)d[c].nodeType===1&&g(d[c],h,a)};b=b.documentElement.childNodes;for(var j=0,e=b.length;j<e;j++)if(b[j].nodeType===
1)b[j].nodeName==="manifest"?g(b[j],{},true):g(b[j],{},false);return l})})(Popcorn);(function(o){o.parser("parseVTT",function(b){var l={title:"",remote:"",data:[]},m=[],f=0,k=0,n=0,g,j,e,c=function(h){var i=h.split(":");h=h.length;var p;if(h!==12&&h!==9)throw"Bad cue";h=i.length-1;try{p=parseInt(i[h-1],10)*60+parseFloat(i[h],10);if(h===2)p+=parseInt(i[0],10)*3600}catch(t){throw"Bad cue";}return p},d=function(h,i){var p={};p[h]=i;return p};b=b.text.split(/(?:\r\n|\r|\n)/gm);for(k=b.length;f<k;){e={};j=[];try{e.id=b[f++];if(!e.id||e.id.indexOf("--\>")!==-1)throw"Bad cue";g=b[f++].split(/[\t ]*--\>[\t ]*/);
e.start=c(g[0]);n=g[1].indexOf(" ");if(n!==-1)g[1]=g[1].substr(0,n);for(e.end=c(g[1]);f<k&&b[f];)j.push(b[f++]);e.text=j.join("<br />");m.push(d("subtitle",e))}catch(a){for(;f<k&&b[f];)f++}for(;f<k&&!b[f];)f++}l.data=m;return l})})(Popcorn);
